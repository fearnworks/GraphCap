
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>[RFC] OMI Distributed Captioning System Architecture &#8212; graphcap  0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'distributed_caption_rfc';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">graphcap  0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="core/index.html">
    Core
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="server/index.html">
    Server
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="development/index.html">
    Development
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="ui/index.html">
    UI Documentation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="core/index.html">
    Core
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="server/index.html">
    Server
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="development/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ui/index.html">
    UI Documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">[RFC] OMI Distributed Captioning System Architecture</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a class="reference external" href="https://github.com/Open-Model-Initiative/OMI-Data-Pipeline/issues/134">link</a>
Pulled 1/22/2025</p>
<section id="rfc-omi-distributed-captioning-system-architecture">
<h1>[RFC] OMI Distributed Captioning System Architecture<a class="headerlink" href="#rfc-omi-distributed-captioning-system-architecture" title="Link to this heading">#</a></h1>
<p><img alt="Image" src="https://github.com/user-attachments/assets/3b004b41-883d-4079-bced-23576e825db6" /></p>
<p><strong>Created:</strong> 1/16/2025</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#1-summary--overview"><span class="xref myst">Summary &amp; Overview</span></a></p></li>
<li><p><a class="reference internal" href="#2-background"><span class="xref myst">Background</span></a></p></li>
<li><p><a class="reference internal" href="#3-proposal"><span class="xref myst">Proposal</span></a></p></li>
<li><p><a class="reference internal" href="#4-system-components"><span class="xref myst">System Components</span></a></p></li>
<li><p><a class="reference internal" href="#5-data-model-and-storage"><span class="xref myst">Data Model and Storage</span></a></p></li>
<li><p><a class="reference internal" href="#6-export-and-upload-process"><span class="xref myst">Export and Upload Process</span></a></p></li>
<li><p><a class="reference internal" href="#7-quality-attributes"><span class="xref myst">Quality Attributes</span></a></p></li>
<li><p><a class="reference internal" href="#8-implementation-strategy"><span class="xref myst">Implementation Strategy</span></a></p></li>
<li><p><a class="reference internal" href="#9-user-flow"><span class="xref myst">User Flow</span></a></p></li>
<li><p><a class="reference internal" href="#10-open-questions--future-work"><span class="xref myst">Open Questions &amp; Future Work</span></a></p></li>
<li><p><a class="reference internal" href="#11-out-of-scope"><span class="xref myst">Out of Scope</span></a></p></li>
</ol>
</section>
<section id="summary-overview">
<h2>1. Summary &amp; Overview<a class="headerlink" href="#summary-overview" title="Link to this heading">#</a></h2>
<p>The <strong>OMI Distributed Captioning System</strong> is a platform that enables a community of contributors to collaboratively build a large, high-quality, open-source image caption dataset. The system combines local processing (for caption generation) with a centrally-managed backend (for secure uploads, moderation, and indexing) to support both simple text captions and more advanced scene-based annotations (GraphCaption). By decentralizing heavy computation to contributors’ local machines, it minimizes central infrastructure costs while enabling a robust, scalable, and flexible annotation pipeline.</p>
</section>
<section id="background">
<h2>2. Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<p>The <strong>Open Model Initiative (OMI)</strong> was founded to foster open-source AI models and datasets. A recurring challenge is constructing large, richly annotated image caption datasets. Centralized approaches place significant burdens on infrastructure while limiting community collaboration.</p>
<p>This distributed model addresses these concerns:</p>
<ul class="simple">
<li><p><strong>Local Contribution</strong>: Contributors run captioning models with local or cloud-based GPU resources through openai compatible endpoints (vllm, ollama, openrouter, gemini, etc) and prepare their data for submission.</p></li>
<li><p><strong>Structured or Unstructured</strong>: Simple text-based captions can coexist with more complex scene-graph annotations (GraphCaption).</p></li>
<li><p><strong>Moderation and Compliance</strong>: A central repository enforces data quality and policies, ensuring that all contributions meet community guidelines.</p></li>
</ul>
<section id="abandoned-idea-one-shot-graph-captions">
<h3>Abandoned Idea: One-Shot Graph Captions<a class="headerlink" href="#abandoned-idea-one-shot-graph-captions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Early prototypes utilized a single high-end model to produce graph captions in one go. While effective, it demanded specialized hardware beyond normal consumer availability. This approach is shelved in favor of a more accessible, incremental pipeline.</p></li>
</ul>
</section>
<section id="glossary">
<h3>Glossary<a class="headerlink" href="#glossary" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>GraphCaption</strong></p></td>
<td><p>A structured format for image annotations that includes nodes (objects, attributes) and edges (relationships between objects) to provide a detailed scene description.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>JSONL</strong></p></td>
<td><p>A text format where each line is a valid JSON value. Commonly used for storing lists of structured data.</p></td>
</tr>
<tr class="row-even"><td><p><strong>JSONB</strong></p></td>
<td><p>A binary JSON data type in PostgreSQL that allows for efficient storage and querying of JSON data.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>GIN Index</strong></p></td>
<td><p>Generalized Inverted Index in PostgreSQL, particularly efficient for searching within JSONB data.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Perspective</strong></p></td>
<td><p>A single view of an image, typically generated by a different model or approach.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Synthesizer</strong></p></td>
<td><p>A model that takes multiple perspectives and merges them into a single, coherent annotation.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="proposal">
<h2>3. Proposal<a class="headerlink" href="#proposal" title="Link to this heading">#</a></h2>
<section id="architectural-overview">
<h3>3.1 Architectural Overview<a class="headerlink" href="#architectural-overview" title="Link to this heading">#</a></h3>
<p>We propose a <strong>hybrid architecture</strong> featuring:</p>
<ol class="arabic simple">
<li><p><strong>Local Captioning Environment</strong> – Where contributors generate captions (text or structured) and optionally refine them.</p></li>
<li><p><strong>Central Repository (AWS-Hosted)</strong> – Svelte UI for authentication, uploads, and moderation, backed by postgres.</p></li>
<li><p><strong>GPU-Backed Processing Node</strong> – Handles advanced tasks, such as merging multiple perspectives into a single GraphCaption and ViT validation.</p></li>
<li><p><strong>UI-Driven Bulk Uploads</strong> – Prevents direct public writes to the database and ensures secure, moderated data ingestion.</p></li>
</ol>
</section>
<section id="architectural-principles">
<h3>3.2 Architectural Principles<a class="headerlink" href="#architectural-principles" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Modularity &amp; Extensibility</strong>: Multiple models, easy to swap or add new “perspectives.”</p></li>
<li><p><strong>Enhanced Handling of Complexity</strong>: Existing Text-based captions remain easy; advanced scene-graph data can be stored in the same structure.</p></li>
<li><p><strong>Security &amp; Compliance</strong>: Authenticated uploads, moderation pipeline, short-lived tokens.</p></li>
<li><p><strong>Interoperability &amp; Standardization</strong>: Use JSONL for export, GraphCaption stored in JSONB, minimal schema changes.</p></li>
</ul>
</section>
<section id="perspectives-based-captioning">
<h3>3.3 Perspectives-Based Captioning<a class="headerlink" href="#perspectives-based-captioning" title="Link to this heading">#</a></h3>
<p>To further enrich caption diversity and quality, the system utilizes a “perspectives” approach. Rather than relying on a single, all-encompassing caption, contributors can generate multiple captions for each image, with each focusing on different aspects or styles. This strategy directly addresses several objectives. It distributes the computational workload through multiple, focused captioning passes, enabling contributions from a wider range of hardware capabilities. It also allows the capture of specific image attributes, such as style, format, and object focus, leading to more granular and targeted annotations. Additionally, by decoupling caption aspects, the system leverages efficient batch inference techniques like vLLM to improve processing throughput.</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/eb2b7fa3-2cac-4aa1-a27d-ff7f04c7dae9" /></p>
</section>
</section>
<section id="system-components">
<h2>4. System Components<a class="headerlink" href="#system-components" title="Link to this heading">#</a></h2>
<section id="local-captioning-environment">
<h3>4.1 Local Captioning Environment<a class="headerlink" href="#local-captioning-environment" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>OpenAI API compatible Inference</strong>: Allows flexibility in captioning providers (Pixtral, Qwen, JoyCap, etc.).</p></li>
<li><p><strong>Specialized Model Containers</strong>: For synthesizer and graph-caption stages if local hardware permits.</p></li>
<li><p><strong>Local UI</strong>: Handles image upload, caption generation, preview, editing, and pre-validation of data before export.</p></li>
<li><p><strong>Outputs</strong>: Standard JSONL for easy packaging; images optionally uploaded to a HuggingFace dataset.</p></li>
<li><p><strong>Resource Requirements</strong>:</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Usage Level</p></th>
<th class="head"><p>Hardware Requirements</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Basic Captioning</p></td>
<td><p>8GB-24GB VRAM GPU or CPU-only</p></td>
<td><p>Suitable for most consumer GPUs, CPU is slower</p></td>
</tr>
<tr class="row-odd"><td><p>Advanced Processing</p></td>
<td><p>~48GB VRAM (A6000 or similar)</p></td>
<td><p>Can delegate to OMI resources if needed</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="central-repository-backend-fastapi">
<h3>4.2 Central Repository Backend (FastAPI)<a class="headerlink" href="#central-repository-backend-fastapi" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Data Ingestion</strong>: Receives validated uploads, references them in Postgres.</p></li>
<li><p><strong>Moderation &amp; Indexing</strong>: Provides endpoints for the moderation UI, possible integration with GPU node for advanced queries.</p></li>
<li><p><strong>User Management</strong>: Manages roles, authentication, rate limits, and upload tokens.</p></li>
</ul>
</section>
<section id="gpu-backed-processing-node">
<h3>4.3 GPU-Backed Processing Node<a class="headerlink" href="#gpu-backed-processing-node" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Advanced or Compute-Heavy Tasks</strong>: Multi-perspective caption fusion, graph expansion, embeddings.</p></li>
<li><p><strong>Scalability</strong>: Can run multiple GPU instances. A queue system manages job distribution.</p></li>
<li><p><strong>Integration</strong>: Submits results back to Postgres or S3 for the central UI to retrieve.</p></li>
</ul>
</section>
<section id="frontend-svelte-ui">
<h3>4.4 Frontend (Svelte UI)<a class="headerlink" href="#frontend-svelte-ui" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Central UI</strong>: Authenticated uploads, moderation tools.</p></li>
</ul>
</section>
<section id="database-layer-postgres">
<h3>4.5 Database Layer (Postgres)<a class="headerlink" href="#database-layer-postgres" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Annotation Storage</strong>: JSONB field for storing both simple text captions and GraphCaption data.</p></li>
<li><p><strong>Indexes</strong>: Potential GIN indexes on JSONB for performance.</p></li>
</ul>
</section>
<section id="perspectives">
<h3>Perspectives<a class="headerlink" href="#perspectives" title="Link to this heading">#</a></h3>
<p>In the graphcap system, perspectives are specialized modules that provide unique analyses of images. Each perspective focuses on different aspects of the image, such as artistic composition or structured scene analysis. This modular approach allows contributors to generate diverse and rich annotations for images.</p>
<ul class="simple">
<li><p><strong>GraphCaption</strong>: Focuses on structured scene analysis with categorized tags.</p></li>
<li><p><strong>ArtCritic</strong>: Provides artistic analysis focusing on visual and technical elements.</p></li>
</ul>
<p>Perspectives are integral to the distributed captioning system, enabling flexible and scalable image analysis.</p>
</section>
</section>
<section id="data-model-and-storage">
<h2>5. Data Model and Storage<a class="headerlink" href="#data-model-and-storage" title="Link to this heading">#</a></h2>
<section id="annotation-model">
<h3>5.1 Annotation Model<a class="headerlink" href="#annotation-model" title="Link to this heading">#</a></h3>
<p>We will leverage the existing annotation model and the annotation field for storing the graph captions. The graph caption data will be stored as a structured json object within the annotation field. Version strings will be included to manage schema migrations over time. Postgres 17 updates to performance within JSONB structures mitigate most concerns we would traditionally have with the use of this datatype.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Annotation</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;annotations&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">content_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;contents.id&quot;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">annotation</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span> <span class="c1"># Convert to JSONB during Postgres 17 upgrade</span>
    <span class="n">manually_adjusted</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Boolean</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">overall_rating</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">from_user_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;users.id&quot;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">from_team_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;teams.id&quot;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">DateTime</span><span class="p">(</span><span class="n">timezone</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">server_default</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="n">updated_at</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">DateTime</span><span class="p">(</span><span class="n">timezone</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">onupdate</span><span class="o">=</span><span class="n">func</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Content&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span>
    <span class="n">from_user</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span>
    <span class="n">from_team</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span>
    <span class="n">annotation_sources</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span>
        <span class="s2">&quot;AnnotationSource&quot;</span><span class="p">,</span>
        <span class="n">secondary</span><span class="o">=</span><span class="s2">&quot;annotation_sources_link&quot;</span><span class="p">,</span>
        <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotations&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">embeddings</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;AnnotationEmbedding&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotation&quot;</span><span class="p">)</span>
    <span class="n">ratings</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;AnnotationRating&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotation&quot;</span><span class="p">)</span>
    <span class="n">reports</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;AnnotationReport&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;annotation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="graphcaption-format">
<h3>5.2 GraphCaption Format<a class="headerlink" href="#graphcaption-format" title="Link to this heading">#</a></h3>
<p>The GraphCaption format provides a rich structure for describing image contents through interconnected nodes and relationships. Each annotation consists of both required and optional fields that together create a comprehensive scene description.</p>
<p><strong>Validation Rules:</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Requirement</p></th>
<th class="head"><p>Constraints</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p>Required</p></td>
<td><p>Must be “GraphCaption”</p></td>
</tr>
<tr class="row-odd"><td><p>version</p></td>
<td><p>Optional</p></td>
<td><p>String for schema versioning</p></td>
</tr>
<tr class="row-even"><td><p>nodes</p></td>
<td><p>Required</p></td>
<td><p>Array, max 50 nodes</p></td>
</tr>
<tr class="row-odd"><td><p>edges</p></td>
<td><p>Optional</p></td>
<td><p>Must reference valid node IDs</p></td>
</tr>
<tr class="row-even"><td><p>simple_caption</p></td>
<td><p>Optional</p></td>
<td><p>Text summary</p></td>
</tr>
<tr class="row-odd"><td><p>detailed_caption</p></td>
<td><p>Optional</p></td>
<td><p>Longer description</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Fields</strong></p>
<ul class="simple">
<li><p><strong>type</strong> (required): Always <code class="docutils literal notranslate"><span class="pre">&quot;GraphCaption&quot;</span></code>.</p></li>
<li><p><strong>version</strong> (optional): String for future schema evolution.</p></li>
<li><p><strong>nodes</strong> (required array): Each node must have <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">class</span></code>; optional fields <code class="docutils literal notranslate"><span class="pre">attributes</span></code>, <code class="docutils literal notranslate"><span class="pre">bounding_box</span></code>, <code class="docutils literal notranslate"><span class="pre">confidence</span></code>.</p></li>
<li><p><strong>edges</strong> (optional array): Directed relationships with <code class="docutils literal notranslate"><span class="pre">source_node_id</span></code>, <code class="docutils literal notranslate"><span class="pre">target_node_id</span></code>, <code class="docutils literal notranslate"><span class="pre">relation_type</span></code>.</p></li>
<li><p><strong>simple_caption</strong> (optional): Short textual summary.</p></li>
<li><p><strong>detailed_caption</strong> (optional): Longer narrative or thorough description.</p></li>
</ul>
<p><strong>Validation &amp; Limits</strong></p>
<ul class="simple">
<li><p>Up to <strong>50 nodes</strong> per annotation.</p></li>
<li><p>Strict checks for referencing valid node IDs, bounding boxes, confidence ranges.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GraphCaption&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;nodes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;obj1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Person&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;attributes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;red-shirt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;smiling&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;bounding_box&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;confidence&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.95</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;edges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;source_node_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;obj1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;target_node_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;obj2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;relation_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;holding&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;confidence&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.88</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="export-and-upload-process">
<h3>6. Export and Upload Process<a class="headerlink" href="#export-and-upload-process" title="Link to this heading">#</a></h3>
<section id="local-packaging">
<h4>6.1 Local Packaging<a class="headerlink" href="#local-packaging" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>JSONL Files</strong>: Each line represents one image annotation (text or GraphCaption).</p></li>
<li><p><strong>Metadata JSON</strong>: Includes dataset location, version information, and file hash.</p></li>
<li><p><strong>Images</strong>: Stored in HuggingFace datasets or remote URLs for retrieval.</p></li>
</ul>
</section>
<section id="ui-driven-upload">
<h4>6.2 UI-Driven Upload<a class="headerlink" href="#ui-driven-upload" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Authentication</strong>: User logs in using existing auth systems.</p></li>
<li><p><strong>Batch Uploads</strong>: Supports up to approximately 1GB per request (configurable). Larger sets use multi-part or chunked uploads.</p></li>
<li><p><strong>Integrity Checks</strong>: The backend verifies the JSON schema, bounding boxes, and file hash.</p></li>
</ul>
</section>
<section id="moderation-pipeline">
<h4>6.3 Moderation Pipeline<a class="headerlink" href="#moderation-pipeline" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Bulk Moderation Tools</strong>: Allows for the approval or rejection of entire sets or individual records.</p></li>
<li><p><strong>Quality &amp; Compliance</strong>:</p>
<ul>
<li><p><strong>Minimum Criteria</strong>: Must have a valid license per OMI data rights requirements and not violate OMI Content Policy.</p></li>
<li><p><strong>Optional Advanced Checks</strong>: Includes ML-based filters for adversarial or suspicious images.</p></li>
</ul>
</li>
<li><p><strong>Dispute Handling</strong>: Contributors can request a re-review. Final decisions rest with the moderation team.</p></li>
</ul>
</section>
</section>
<section id="quality-attributes">
<h3>7. Quality Attributes<a class="headerlink" href="#quality-attributes" title="Link to this heading">#</a></h3>
<p><strong>Performance &amp; Scalability</strong>
The system achieves horizontal scalability through FastAPI’s autoscaling capabilities, allowing multiple replicas behind a load balancer. For computation-intensive tasks, GPU nodes can be scaled to meet demand spikes.</p>
<p><strong>Reliability</strong>
We ensure data durability through AWS deployment and automated backups. The stateless nature of our containers enables seamless redeployment of both backend and UI components.</p>
<section id="performance-scalability">
<h4>7.1 Performance &amp; Scalability<a class="headerlink" href="#performance-scalability" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>GPU Nodes: Could set up system to scale horizontally on cloud provider (currently Runpod) if there is a surge in advanced tasks.</p></li>
</ul>
</section>
<section id="reliability">
<h4>7.2 Reliability<a class="headerlink" href="#reliability" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Stateless Containers: Both backend and UI can be redeployed seamlessly.</p></li>
</ul>
</section>
<section id="security">
<h4>7.3 Security<a class="headerlink" href="#security" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Rate Limiting &amp; Role-Based Access: Deters abuse or spam uploads.</p></li>
<li><p>File-Type Validation &amp; Virus Scanning: Ensures no malicious content is introduced.</p></li>
<li><p>Automated ML Filters: Potential for detecting adversarial images or policy violations.</p></li>
</ul>
</section>
<section id="maintainability">
<h4>7.4 Maintainability<a class="headerlink" href="#maintainability" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Modular Pipeline: Easy to swap or add new models and annotation types.</p></li>
<li><p>Incremental Schema: GraphCaption is embedded in the same JSON field, requiring no major DB overhauls.</p></li>
</ul>
</section>
</section>
<section id="implementation-strategy">
<h3>8. Implementation Strategy<a class="headerlink" href="#implementation-strategy" title="Link to this heading">#</a></h3>
<p>The system implementation consists of four main components, each with distinct responsibilities and integration points:</p>
<section id="backend-services">
<h4>8.1 Backend Services<a class="headerlink" href="#backend-services" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Key Features</p></th>
<th class="head"><p>Technical Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Database Layer</p></td>
<td><p>• Data Persistence<br>• Query Optimization</p></td>
<td><p>• Postgres 17 with JSONB<br>• GIN indexes for annotation search<br>• Partitioning for large datasets</p></td>
</tr>
<tr class="row-odd"><td><p>GPU Processing</p></td>
<td><p>• Async Task Processing<br>• Resource Management</p></td>
<td><p>• Queue-based architecture<br>• Auto-scaling worker pools<br>• Result persistence strategy</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="local-environment">
<h4>8.2 Local Environment<a class="headerlink" href="#local-environment" title="Link to this heading">#</a></h4>
<p>The contributor environment is delivered as a Docker container with the following architecture:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Layer</p></th>
<th class="head"><p>Components</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Interface</p></td>
<td><p>• Web UI for caption editing<br>• CLI for batch operations</p></td>
</tr>
<tr class="row-odd"><td><p>Processing</p></td>
<td><p>• Model inference <br>• Local validation suite</p></td>
</tr>
<tr class="row-even"><td><p>Export</p></td>
<td><p>• JSONL generation<br>• Metadata packaging<br>• Upload utilities</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="integration-points">
<h4>8.3 Integration Points<a class="headerlink" href="#integration-points" title="Link to this heading">#</a></h4>
<p>Critical system interactions include:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Integration</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Local → Backend</p></td>
<td><p>Dataset submission</p></td>
<td><p>• Chunked uploads<br>• Validation handshake<br>• Progress tracking</p></td>
</tr>
<tr class="row-odd"><td><p>Backend → GPU</p></td>
<td><p>Processing requests</p></td>
<td><p>• Task queue integration<br>• Resource allocation<br>• Result aggregation</p></td>
</tr>
<tr class="row-even"><td><p>UI → Backend</p></td>
<td><p>Moderation workflow</p></td>
<td><p>• Real-time updates<br>• Bulk operations<br>• Audit logging</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="deployment-strategy">
<h4>8.4 Deployment Strategy<a class="headerlink" href="#deployment-strategy" title="Link to this heading">#</a></h4>
<p>The system will be deployed in phases:</p>
<ol class="arabic simple">
<li><p><strong>Alpha Release</strong> (Phase 1)</p></li>
</ol>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Features</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Local</p></td>
<td><p>• Image Upload <br>• Perspective Captions<br>• HuggingFace Dataset Export<br>• Jsonl Export</p></td>
</tr>
<tr class="row-odd"><td><p>Central UI</p></td>
<td><p>• Jsonl upload</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Beta Release</strong> (Phase 2)</p>
<ul class="simple">
<li><p>GPU processing integration</p></li>
<li><p>Enhanced validation</p></li>
<li><p>Advance Moderation features</p></li>
</ul>
</li>
<li><p><strong>Production Release</strong> (Phase 3)</p>
<ul class="simple">
<li><p>Full feature set</p></li>
<li><p>Performance optimization</p></li>
<li><p>Production monitoring</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="user-flow">
<h3>9. User Flow<a class="headerlink" href="#user-flow" title="Link to this heading">#</a></h3>
<section id="contributors">
<h4>9.1 Contributors<a class="headerlink" href="#contributors" title="Link to this heading">#</a></h4>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>flowchart TD
    A[Start] --&gt; B[Run Local Models: Generate text or GraphCaption]
    B --&gt; C[Review &amp; Refine: Use the local UI to fix bounding boxes, attributes]
    C --&gt; D[Export: Create JSONL and metadata.json]
    D --&gt; E[Upload]
    E --&gt; F[End]
</pre></div>
</div>
<ul class="simple">
<li><p>Run Local Models: Generate text or GraphCaption.</p></li>
<li><p>Review &amp; Refine: Use the local UI to fix bounding boxes, attributes.</p></li>
<li><p>Export: Create JSONL and metadata.json, then upload.</p></li>
</ul>
</section>
<section id="moderators">
<h4>9.2 Moderators<a class="headerlink" href="#moderators" title="Link to this heading">#</a></h4>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>flowchart TD
    A[Start] --&gt; B[Receive Uploads: Svelte UI shows new datasets for moderation]
    B --&gt; C[Bulk or Individual Review: Check data quality, content compliance]
    C --&gt; D{Decision}
    D --&gt;|Approve| E[Integrate into main repository]
    D --&gt;|Reject| F[Flag for removal]
    E --&gt; G[End]
    F --&gt; G[End]
</pre></div>
</div>
<ul class="simple">
<li><p>Receive Uploads: Svelte UI shows new datasets for moderation.</p></li>
<li><p>Bulk or Individual Review: Check data quality, content compliance.</p></li>
<li><p>Approve or Reject: Final submission gets integrated or flagged for removal.</p></li>
</ul>
</section>
</section>
<section id="qa-open-questions">
<h3>10. QA / Open Questions<a class="headerlink" href="#qa-open-questions" title="Link to this heading">#</a></h3>
<section id="qa">
<h4>QA<a class="headerlink" href="#qa" title="Link to this heading">#</a></h4>
<blockquote>
<div><p>How should we handle the moderation process?</p>
</div></blockquote>
<p>A standardized evaluation framework should be established to guide moderators in assessing submissions while maintaining sufficient flexibility for exceptional cases. This balanced approach enables consistent quality control while allowing moderators’ expertise to inform and improve evaluation criteria over time.</p>
<blockquote>
<div><p>How should we handle the appeals process?
Appeals should be handled through established communication channels (email or Discord) rather than building dedicated application functionality. This approach:</p>
</div></blockquote>
<ol class="arabic simple">
<li><p>Leverages existing infrastructure</p></li>
<li><p>Facilitates direct communication between moderators and contributors</p></li>
<li><p>Allows for nuanced discussion and resolution</p></li>
<li><p>Reduces development overhead</p></li>
<li><p>Maintains flexibility in the appeals process</p></li>
</ol>
<p>The specific process should be documented in the contributor guidelines, including:</p>
<ul class="simple">
<li><p>Primary point of contact</p></li>
<li><p>Expected response times</p></li>
<li><p>Required information for appeals</p></li>
<li><p>Possible outcomes</p></li>
</ul>
</section>
<section id="open-questions">
<h4>Open Questions<a class="headerlink" href="#open-questions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Do we need to utilize the fastapi at all here or will the svelte backend be sufficient?</p></li>
</ul>
<section id="moderation-ux">
<h5>Moderation UX<a class="headerlink" href="#moderation-ux" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>How will we handle viewing the images in the app for moderation ux when it is stored in the HF dataset?</p></li>
</ul>
</section>
<section id="gpu-node">
<h5>GPU Node<a class="headerlink" href="#gpu-node" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>How to manage GPU resources (autoscaling, job scheduling)?</p></li>
<li><p>Handling queue backlogs, job prioritization, metrics?</p></li>
</ul>
</section>
<section id="security-rate-limiting">
<h5>Security &amp; Rate Limiting<a class="headerlink" href="#security-rate-limiting" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>Policy for banning or revoking access on repeated malicious uploads?</p></li>
</ul>
</section>
<section id="offline-or-partial-upload">
<h5>Offline or Partial Upload<a class="headerlink" href="#offline-or-partial-upload" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>Could the local UI handle incremental, offline preparations of data before final sync?</p></li>
</ul>
</section>
</section>
<section id="out-of-scope">
<h4>11. Out of Scope<a class="headerlink" href="#out-of-scope" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>General Database Backup: Standard AWS backups or external solutions apply but are not covered here in detail.</p></li>
<li><p>Comprehensive Disaster Recovery: The system expects standard cloud practices but does not define them in this RFC.</p></li>
<li><p>Detailed API Documentation: Will be addressed separately, likely via an OpenAPI/Swagger specification.</p></li>
</ul>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-overview">1. Summary &amp; Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">2. Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abandoned-idea-one-shot-graph-captions">Abandoned Idea: One-Shot Graph Captions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#glossary">Glossary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposal">3. Proposal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#architectural-overview">3.1 Architectural Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#architectural-principles">3.2 Architectural Principles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perspectives-based-captioning">3.3 Perspectives-Based Captioning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-components">4. System Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-captioning-environment">4.1 Local Captioning Environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#central-repository-backend-fastapi">4.2 Central Repository Backend (FastAPI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu-backed-processing-node">4.3 GPU-Backed Processing Node</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frontend-svelte-ui">4.4 Frontend (Svelte UI)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#database-layer-postgres">4.5 Database Layer (Postgres)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perspectives">Perspectives</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-model-and-storage">5. Data Model and Storage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotation-model">5.1 Annotation Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphcaption-format">5.2 GraphCaption Format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-and-upload-process">6. Export and Upload Process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#local-packaging">6.1 Local Packaging</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ui-driven-upload">6.2 UI-Driven Upload</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#moderation-pipeline">6.3 Moderation Pipeline</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-attributes">7. Quality Attributes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-scalability">7.1 Performance &amp; Scalability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reliability">7.2 Reliability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#security">7.3 Security</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maintainability">7.4 Maintainability</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-strategy">8. Implementation Strategy</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#backend-services">8.1 Backend Services</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#local-environment">8.2 Local Environment</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-points">8.3 Integration Points</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment-strategy">8.4 Deployment Strategy</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-flow">9. User Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contributors">9.1 Contributors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#moderators">9.2 Moderators</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qa-open-questions">10. QA / Open Questions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qa">QA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#open-questions">Open Questions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#moderation-ux">Moderation UX</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu-node">GPU Node</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#security-rate-limiting">Security &amp; Rate Limiting</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#offline-or-partial-upload">Offline or Partial Upload</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#out-of-scope">11. Out of Scope</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/distributed_caption_rfc.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, graphcap Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>